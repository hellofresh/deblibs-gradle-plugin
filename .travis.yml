language: java

before_cache:
- rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
    directories:
    - "$HOME/.gradle/caches/"
    - "$HOME/.gradle/wrapper/"
script:
- "./gradlew build --no-daemon"
- if [ -n "$TRAVIS_TAG" ]; then ./gradlew build publishPlugins --no-daemon; fi

env:
  global:
  # GRADLE_PUBLISH_KEY
  - secure: secure gradle publish key
  # GRADLE_PUBLISH_SECRET
  - secure: secure gradle secrete key
